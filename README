This code does power density analysis of both sides of the magnetopause boundary using Cassini magnetometer fluctuations. Magnetometer_data_analysis.m uses spacecraft position given each hour in Cassini_orbits_2004-2012.txt to give Local Time and radial distance from Saturn for a set of magnetopause boundary identifications given in Delamere_bc_ids-2.txt where region 1 is in the magnetosphere and region 2 is in the sheath (-1 is solar wind). Furthermore, Magnetometer_data_analysis.m calculates a heating rate density for each selected 10 minute window using a power spectrum calculated from the magnetic fluctuations as well as a q_delB calculated from the standard devation of the magnetic fluctuations from the mean (this second calculation probably isn't properly implemented for the sheath side). This is the main file and can be used to calculate q values for both the magnetodisc inside the magnetosphere and magnetosheath each requiring a different model for temperature, density, and v_rel. For the magnetosphere the models have been hard coded into the three files get_density, get_temperature, and get_v_rel so further discussion with Vitaliy is necessary to understand these while in the sheath model polynomials are constructed in models_for_sheath.m from LANL moments which can be evaluated at any Local Time or one can use the data directly by calling find_moment_data.m which will use the LANL moments given for time period of the selected window if they are present, else it used the model moments mentioned first. Plot_data.m is next most important as it takes the data produced by magnetometer_data_analysis.m given in the form of a 19 row matrix whose values are as follows (not all of these are obviously pertinent at the moment and might have been used for a past test/debugging) 1. q_KAW 2.q_MHD 3.# of windows away from boundary 4. Local Time 5. Radial distance 6. B_r mean 7. B_theta mean 8. B_phi mean 9. KAW slope 10. MHD slope 11. year 12. month 13. day 14. hour 15. minute 16. second 17. latitude 18. v_phi_rel 19. v_r_rel. Outliers in the data are first filtered, then q values are averaged in local time, latitude, radial distance, and distance to the subsolar point all as a function of # of 10 minute windows from the boundary. One can use plot_qs_data.m to inspect the distribution of boundary crossings, intended to also highlight crossings in which another neighboring crossing happens in a span of less than 20 minutes, since the velocity of the spacecraft is essentially zero with respect to the moving magnetopause boundary responding to the solar wind dynamic pressure. The final stand-alone function is find_interesting_particle_data.m which requires the same data as plot_data but in addition the magnetometer data for each window. It will then allow one to visually investigate the windows which produced outlier heating rates by plotting LEMMS particle data, CAPS data, and Cassini magnetometer data. This can be used to look at windows with outlier heating rates, energy cascade slopes, and lastly data which is selected where a boundary crossing has B_phi as the dominant magnetic field component. In the last case the data will actually include the boundary, whereas for the calculation of heating rates the first window begins 2 minutes after the crossing file has identified a boundary, in order to avoid the boundary layer where material could be of either sheath or magnetospheric origin.
